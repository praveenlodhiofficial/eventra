generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

enum Role {
  USER
  ADMIN
}

model User {
  id          String  @id @default(cuid())
  name        String?
  email       String  @unique
  password    String
  phoneNumber String?
  role        Role    @default(USER)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model EventCategory {
  id     String  @id @default(cuid())
  name   String  @unique
  slug   String  @unique

  events Event[] @relation("EventCategories")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model EventImage {
  id       String @id @default(cuid())
  url      String
  
  eventId  String
  event    Event  @relation(fields: [eventId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
}

model Event {
  id          String @id @default(cuid())
  name        String
  slug        String @unique
  description String
  
  coverImage  String
  images       EventImage[]

  categories  EventCategory[] @relation("EventCategories")
  city     String


  performers Performer[] @relation("EventPerformers")

  startAt DateTime
  endAt   DateTime

  price Decimal @db.Decimal(10, 2)

  venueId String
  venue   Venue  @relation(fields: [venueId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([startAt])
  @@index([venueId])
}

model Performer {
  id    String  @id @default(cuid())
  name  String
  slug  String @unique
  image String
  bio   String

  events Event[] @relation("EventPerformers")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Venue {
  id      String @id @default(cuid())
  name    String
  address String
  city    String
  state   String
  country String
  pincode String

  events Event[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
